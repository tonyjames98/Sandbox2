<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-CWLM2ED828"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-CWLM2ED828');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="See Your Financial Future in Minutes! Free calculator to visualize wealth growth, plan investments, and achieve money goals. No signup—start projecting now!">
    <meta name="keywords" content="financial projection calculator, investment growth calculator, net worth tracker, wealth planning tool, retirement savings calculator, financial goal planner, future net worth estimator, free finance calculator, money projection tool">
    <meta name="author" content="My Projection Calculator">
    <meta name="robots" content="index, follow">
    <meta name="language" content="English">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://myprojectioncalculator.com/">
    <meta property="og:title" content="My Projection Calculator - Free Financial Planning Tool">
    <meta property="og:description" content="See Your Financial Future in Minutes! Visualize wealth growth, plan investments, and achieve your money goals. 100% free—no signup required!">
    <meta property="og:image" content="https://myprojectioncalculator.com/og-image.png">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://myprojectioncalculator.com/">
    <meta property="twitter:title" content="My Projection Calculator - Free Financial Planning Tool">
    <meta property="twitter:description" content="See Your Financial Future in Minutes! Visualize wealth growth, plan investments, and achieve your money goals. 100% free—no signup required!">
    <meta property="twitter:image" content="https://myprojectioncalculator.com/og-image.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://myprojectioncalculator.com/">
    
    <title>My Projection Calculator - Free Financial Planning Tool</title>
    
    <!-- Fonts and Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Preload critical resources -->
    <link rel="preload" href="styles.css" as="style">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/chart.js" as="script">
    
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <!-- Structured Data for SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "My Projection Calculator",
        "description": "Free personal finance projection calculator for investment planning and net worth tracking",
        "url": "https://myprojectioncalculator.com",
        "applicationCategory": "FinanceApplication",
        "operatingSystem": "Web Browser",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "featureList": [
            "Investment tracking",
            "Financial projections",
            "Net worth calculator",
            "Chart visualizations",
            "Data export",
            "Share projections"
        ],
        "author": {
            "@type": "Organization",
            "name": "My Projection Calculator"
        }
    }
    </script>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar Navigation (Desktop) -->
        <div id="sidebar-overlay" class="sidebar-overlay"></div>
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="brand" onclick="switchTab('dashboard')" role="button" tabindex="0">
                    <div class="brand-icon">
                        <i data-lucide="bar-chart-3"></i>
                    </div>
                    <div class="brand-text">
                        <span class="brand-name">My Projection</span>
                        <span class="brand-tagline">Finance Planner</span>
                    </div>
                </div>
                <button class="mobile-close-btn" id="mobile-sidebar-close">
                    <i data-lucide="x"></i>
                </button>
            </div>
            
            <nav class="sidebar-nav">
                <button class="nav-item active" data-tab="dashboard">
                    <i data-lucide="layout-dashboard"></i>
                    <span>Dashboard</span>
                </button>
                <button class="nav-item" data-tab="investments">
                    <i data-lucide="briefcase"></i>
                    <span>Investments/Debt</span>
                </button>
                <button class="nav-item" data-tab="events">
                    <i data-lucide="calendar"></i>
                    <span>Income/Events</span>
                </button>
                <button class="nav-item" data-tab="goals">
                    <i data-lucide="target"></i>
                    <span>Financial Goals</span>
                </button>
                <button class="nav-item" data-tab="export">
                    <i data-lucide="file-output"></i>
                    <span>Export/Share</span>
                </button>
                <button class="nav-item" data-tab="guide">
                    <i data-lucide="help-circle"></i>
                    <span>Guide</span>
                </button>
                <button class="nav-item" data-tab="ai-analysis">
                    <i data-lucide="bot"></i>
                    <span>AI Analysis</span>
                </button>
            </nav>
            
            <div class="sidebar-footer">
                <button class="theme-toggle" id="mobile-theme-toggle">
                    <i data-lucide="moon" class="moon-icon"></i>
                    <i data-lucide="sun" class="sun-icon"></i>
                    <span>Dark Mode</span>
                </button>
                <button class="btn-reset" onclick="resetAllData()">
                    <i data-lucide="trash-2"></i>
                    <span>Reset Data</span>
                </button>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="main-content">
            <header class="top-bar">
                <button class="mobile-menu-btn" id="mobile-menu-toggle-btn">
                    <i data-lucide="menu"></i>
                </button>
                <h1 id="page-title">Dashboard</h1>
            </header>

            <div class="viewport">
                <!-- Dashboard Tab -->
                <div class="tab-content active" id="dashboard">
                    <div class="kpi-grid">
                        <div class="kpi-card primary" onclick="quickAddInvestment('Cash')" role="button" style="cursor: pointer;">
                            <div class="kpi-header">
                                <span>Current Net Worth</span>
                                <i data-lucide="wallet"></i>
                            </div>
                            <div class="kpi-value" id="current-net-worth">$0</div>
                            <div class="kpi-subtitle" id="onboarding-sample-container">
                                <button class="btn-text btn-sm" onclick="event.stopPropagation(); loadSampleScenario()" style="color: var(--text-on-gradient); opacity: 0.9; text-decoration: underline;">
                                    Try Sample Scenario
                                </button>
                            </div>
                            <div class="kpi-action">
                                <i data-lucide="plus"></i>
                            </div>
                        </div>
                        <div class="kpi-card secondary">
                            <div class="kpi-header">
                                <span>Projected Future</span>
                                <i data-lucide="trending-up"></i>
                            </div>
                            <div class="kpi-value" id="projected-net-worth-value">$0</div>
                            <div class="kpi-subtitle" id="projection-years-label">In 30 Years</div>
                        </div>
                        <div class="kpi-card accent" onclick="quickAddEvent()" role="button" style="cursor: pointer;">
                            <div class="kpi-header">
                                <span>Portfolio Summary</span>
                                <i data-lucide="pie-chart"></i>
                            </div>
                            <div class="kpi-stats">
                                <div class="mini-stat">
                                    <span id="investment-count">0</span>
                                    <label>Assets</label>
                                </div>
                                <div class="mini-stat">
                                    <span id="event-count">0</span>
                                    <label>Events</label>
                                </div>
                            </div>
                            <div class="kpi-subtitle">&nbsp;</div>
                            <div class="kpi-action">
                                <i data-lucide="plus"></i>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-charts">
                        <div class="chart-card main-chart">
                            <div class="chart-header">
                                <div class="header-title-group">
                                    <h3>Net Worth Projection</h3>
                                    <div id="scenario-controls" class="scenario-controls" style="display: none;">
                                        <span class="scenario-badge">Comparing with Baseline</span>
                                        <button class="btn-text btn-sm" onclick="resetToBaseline()" title="Revert to baseline state">
                                            <i data-lucide="rotate-ccw"></i> Reset
                                        </button>
                                        <button class="btn-text btn-sm" onclick="clearBaseline()" title="Commit these changes as your new baseline">
                                            <i data-lucide="check"></i> Set this as my new baseline
                                        </button>
                                    </div>
                                </div>
                                <div class="chart-controls">
                                    <div class="inflation-controls">
                                        <div class="toggle-wrapper">
                                            <label class="switch">
                                                <input type="checkbox" id="adjust-inflation" onchange="toggleInflationInput()">
                                                <span class="slider"></span>
                                            </label>
                                            <span class="toggle-label">Inflation</span>
                                        </div>
                                        <div id="inflation-rate-wrapper" class="inflation-rate-input-wrapper" style="display: none;">
                                            <input type="number" id="inflation-rate" step="0.1" value="2.5" min="0" max="20">
                                            <span class="input-suffix">%</span>
                                        </div>
                                    </div>
                                    <button id="save-baseline-btn" class="btn btn-outline btn-sm" onclick="saveBaseline()">
                                        <i data-lucide="save"></i>
                                        <span>Set Baseline</span>
                                    </button>
                                    <div class="input-group">
                                        <label for="projection-years-input">Years</label>
                                        <input type="number" id="projection-years-input" min="1" max="60" value="30">
                                    </div>
                                    <button class="btn btn-primary" onclick="runProjection()">
                                        <i data-lucide="play"></i>
                                        <span>Run</span>
                                    </button>
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="net-worth-chart"></canvas>
                            </div>
                            <!-- What-If Sliders -->
                            <div class="what-if-controls">
                                <div class="what-if-header">
                                    <i data-lucide="zap" style="width: 16px; height: 16px; color: var(--warning);"></i>
                                    <span>What-If Scenarios</span>
                                    <button class="btn-text btn-sm" onclick="resetWhatIfSliders()" id="reset-what-if" style="display: none; margin-left: auto;">Reset</button>
                                </div>
                                <div class="sliders-grid">
                                    <div class="slider-group">
                                        <div class="slider-info">
                                            <label>Market Performance</label>
                                            <span id="market-offset-val">0%</span>
                                        </div>
                                        <input type="range" id="market-performance-slider" min="-5" max="5" step="0.1" value="0" oninput="updateWhatIf()">
                                        <div class="slider-labels">
                                            <span>Bear (-5%)</span>
                                            <span>Bull (+5%)</span>
                                        </div>
                                    </div>
                                    <div class="slider-group">
                                        <div class="slider-info">
                                            <label>Monthly Savings Boost</label>
                                            <span id="savings-boost-val">$0</span>
                                        </div>
                                        <input type="range" id="savings-boost-slider" min="0" max="10000" step="100" value="0" oninput="updateWhatIf()">
                                        <div class="slider-labels">
                                            <span>$0</span>
                                            <span>$10k</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="chart-card side-chart">
                            <h3>Asset Allocation</h3>
                            <div class="chart-container">
                                <canvas id="allocation-chart"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-section">
                        <h3>Asset Allocation Over Time</h3>
                        <div class="chart-container tall">
                            <canvas id="allocation-timeline-chart"></canvas>
                        </div>
                    </div>

                    <div class="dashboard-section">
                        <h3>Projection Timeline</h3>
                        <div class="table-container">
                            <table id="projection-table">
                                <thead>
                                    <tr id="projection-table-header">
                                        <th>Year</th>
                                        <th>Net Worth</th>
                                        <th>Growth</th>
                                        <th>Events</th>
                                    </tr>
                                </thead>
                                <tbody id="projection-table-body"></tbody>
                            </table>
                        </div>
                    </div>

                    <div class="dashboard-section portfolio-analysis-section">
                        <div class="section-header">
                            <h3>Portfolio Analysis & Insights</h3>
                            <i data-lucide="info" class="info-icon" onclick="showDisclaimerModal()"></i>
                        </div>
                        <div id="portfolio-insights">
                            <!-- Insights populated by JS -->
                        </div>
                    </div>
                </div>

                <!-- Investments Tab -->
                <div class="tab-content" id="investments">
                    <div class="content-header">
                        <h2>Investment/Debt Management</h2>
                        <button class="btn btn-primary" onclick="showAddInvestmentModal()">
                            <i data-lucide="plus"></i>
                            <span>Add Investment/Debt</span>
                        </button>
                    </div>
                    <div class="investments-list" id="investments-list"></div>
                </div>

                <!-- Events Tab -->
                <div class="tab-content" id="events">
                    <div class="content-header">
                        <h2>Financial Events</h2>
                        <div class="header-actions">
                            <button class="btn btn-outline" onclick="showAddEventModal('rebalancing')">
                                <i data-lucide="refresh-cw"></i>
                                <span>Rebalancing</span>
                            </button>
                            <button class="btn btn-primary" onclick="showAddEventModal('expense')">
                                <i data-lucide="plus"></i>
                                <span>Add Event</span>
                            </button>
                        </div>
                    </div>
                    <div class="event-quick-actions">
                        <button class="action-card income" onclick="showAddEventModal('income')">
                            <div class="action-icon"><i data-lucide="trending-up"></i></div>
                            <div class="action-label">Income</div>
                        </button>
                        <button class="action-card expense" onclick="showAddEventModal('expense')">
                            <div class="action-icon"><i data-lucide="trending-down"></i></div>
                            <div class="action-label">Expense</div>
                        </button>
                        <button class="action-card transfer" onclick="showAddEventModal('transfer')">
                            <div class="action-icon"><i data-lucide="repeat"></i></div>
                            <div class="action-label">Transfer</div>
                        </button>
                        <button class="action-card withdrawal" onclick="showAddEventModal('withdrawal')">
                            <div class="action-icon"><i data-lucide="wallet"></i></div>
                            <div class="action-label">Withdrawal</div>
                        </button>
                    </div>
                    <div class="events-list" id="events-list"></div>
                </div>

                <!-- Goals Tab -->
                <div class="tab-content" id="goals">
                    <div class="content-header">
                        <h2>Financial Goals</h2>
                        <button class="btn btn-primary" onclick="showAddGoalModal()">
                            <i data-lucide="plus"></i>
                            <span>Add Goal</span>
                        </button>
                    </div>
                    <div class="goals-grid" id="goals-list"></div>
                </div>

                <!-- Export Tab -->
                <div class="tab-content" id="export">
                    <div class="content-header">
                        <h2>Export & Sharing</h2>
                    </div>
                    <div class="export-grid">
                        <div class="card export-card">
                            <i data-lucide="file-text"></i>
                            <h3>Projection Data</h3>
                            <p>Download your full projection timeline.</p>
                            <div class="card-actions">
                                <button class="btn btn-outline" onclick="exportProjectionCSV()">CSV</button>
                                <button class="btn btn-primary" onclick="exportProjectionExcel()">Excel</button>
                            </div>
                        </div>
                        <div class="card export-card">
                            <i data-lucide="database"></i>
                            <h3>Raw Data</h3>
                            <p>Export your investments and events as JSON.</p>
                            <button class="btn btn-secondary" onclick="exportRawData()">Export JSON</button>
                        </div>
                        <div class="card export-card">
                            <i data-lucide="share-2"></i>
                            <h3>Share Link</h3>
                            <p>Create a shareable link to your projection.</p>
                            <button class="btn btn-primary" onclick="shareProjection()">Copy Link</button>
                        </div>
                    </div>
                </div>

                <!-- Guide Tab -->
                <div class="tab-content" id="guide">
                    <div class="content-header">
                        <h2>User Guide</h2>
                    </div>
                    <div class="guide-grid" id="guide-content">
                        <div class="card guide-card">
                            <i data-lucide="layout-dashboard"></i>
                            <h3>Dashboard Overview</h3>
                            <p>Get a high-level view of your current net worth, projected future wealth, and asset allocation. Use the <strong>Run</strong> button to update projections based on your latest inputs.</p>
                        </div>
                        <div class="card guide-card">
                            <i data-lucide="briefcase"></i>
                            <h3>Managing Investments</h3>
                            <p>Add your bank accounts, brokerage portfolios, real estate, or other assets in the <strong>Investments</strong> tab. Each asset can have its own expected return rate and target allocation.</p>
                        </div>
                        <div class="card guide-card">
                            <i data-lucide="calendar"></i>
                            <h3>Planning Events</h3>
                            <p>Model life changes in the <strong>Income/Events</strong> tab. You can add one-time expenses, recurring income, or portfolio rebalancing. Recurring events like withdrawals can have <strong>no end date</strong> (they'll run for the full projection duration), and you can choose to withdraw a <strong>percentage (%) of your account balance</strong> instead of a fixed amount.</p>
                        </div>
                        <div class="card guide-card">
                            <i data-lucide="bot"></i>
                            <h3>AI Financial Analysis</h3>
                            <p>Use the <strong>AI Analysis</strong> tool to generate a detailed prompt for ChatGPT or other AI models. It uses your data to provide personalized insights and strategy recommendations.</p>
                        </div>
                        <div class="card guide-card">
                            <i data-lucide="share-2"></i>
                            <h3>Export & Sharing</h3>
                            <p>Take your data with you. Export your projection timeline to <strong>CSV</strong> or <strong>Excel</strong>, or generate a unique <strong>Share Link</strong> to save or send your plan to others.</p>
                        </div>
                        <div class="card guide-card">
                            <i data-lucide="refresh-cw"></i>
                            <h3>Data Privacy</h3>
                            <p>Your data is stored <strong>locally in your browser</strong>. We don't store your financial information on any servers. Be sure to export your data if you switch browsers or devices.</p>
                        </div>
                    </div>
                </div>

                <!-- AI Analysis Tab -->
                <div class="tab-content" id="ai-analysis">
                    <div class="content-header">
                        <h2>AI Financial Analysis</h2>
                    </div>
                    <div class="ai-container">
                        <div class="card ai-card main">
                            <i data-lucide="zap"></i>
                            <h3>Quick AI Analysis</h3>
                            <p>Analyze your data directly with ChatGPT.</p>
                            <button class="btn btn-primary" onclick="openChatGPT()">Launch ChatGPT</button>
                        </div>
                        <div class="card ai-card">
                            <h3>Manual Analysis</h3>
                            <textarea id="manual-prompt" readonly></textarea>
                            <button class="btn btn-outline" onclick="copyManualPrompt()">Copy Prompt</button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Mobile Bottom Navigation -->
    <nav class="bottom-nav">
        <button class="bottom-nav-item active" data-tab="dashboard">
            <i data-lucide="layout-dashboard"></i>
            <span>Home</span>
        </button>
        <button class="bottom-nav-item" data-tab="investments">
            <i data-lucide="briefcase"></i>
            <span>Assets/Debt</span>
        </button>
        <button class="bottom-nav-item" data-tab="events">
            <i data-lucide="calendar"></i>
            <span>Events</span>
        </button>
        <button class="bottom-nav-item" data-tab="goals">
            <i data-lucide="target"></i>
            <span>Goals</span>
        </button>
        <button class="bottom-nav-item" data-tab="ai-analysis">
            <i data-lucide="bot"></i>
            <span>AI</span>
        </button>
    </nav>

    <!-- Modals (IDs preserved) -->
    <div class="modal" id="investment-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Investment/Debt Details</h3>
                <button class="close-btn" onclick="closeModal('investment-modal')"><i data-lucide="x"></i></button>
            </div>
            <form id="investment-form">
                <!-- Form fields preserved with updated styling -->
                <div class="form-group">
                    <label>Name</label>
                    <input type="text" id="investment-name" required placeholder="e.g. S&P 500 Index">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Type</label>
                        <select id="investment-type" onchange="updateInvestmentDefaults()">
                            <option value="Stocks">Stocks</option>
                            <option value="Bonds">Bonds</option>
                            <option value="Real Estate">Real Estate</option>
                            <option value="Cash">Cash</option>
                            <option value="Cryptocurrency">Crypto</option>
                            <option value="Mutual Fund/Index Fund">Fund</option>
                            <option value="Debt">Debt/Loan</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label id="investment-amount-label">Initial Amount ($)</label>
                        <input type="number" id="investment-amount" required value="10000">
                    </div>
                    <div class="form-group">
                        <label id="investment-return-label">Return Rate (%)</label>
                        <input type="number" id="investment-return" required value="7" step="0.1">
                    </div>
                </div>
                <div id="debt-fields" class="form-group" style="display: none;">
                    <label>Monthly Payment ($)</label>
                    <input type="number" id="debt-payment" value="0">
                    <span class="input-hint">This amount will be deducted from your first asset/income every month to pay down this debt.</span>
                </div>
                <div class="modal-footer">
                    <button type="button" id="delete-investment-btn" class="btn btn-danger" style="display: none; margin-right: auto;" onclick="deleteCurrentInvestment()">Delete Item</button>
                    <button type="button" class="btn btn-text" onclick="closeModal('investment-modal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Item</button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal" id="event-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="event-modal-title">Financial Event</h3>
                <button class="close-btn" onclick="closeModal('event-modal')"><i data-lucide="x"></i></button>
            </div>
            <form id="event-form">
                <div class="form-group">
                    <label>Event Type</label>
                    <select id="event-type" onchange="updateEventForm()">
                        <option value="income">Income</option>
                        <option value="expense">Expense</option>
                        <option value="transfer">Transfer</option>
                        <option value="withdrawal">Withdrawal</option>
                        <option value="rebalancing">Rebalancing</option>
                    </select>
                </div>
                <!-- Unified Event Fields -->
                <div class="form-group" id="recurring-toggle-group">
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                        <input type="checkbox" id="event-is-recurring" style="width: auto;" onchange="toggleRecurringFields()">
                        <span>Is this a recurring event?</span>
                    </label>
                </div>

                <div id="common-fields" class="event-fields">
                    <div id="one-time-date-group" class="form-group">
                        <label>Date</label>
                        <input type="date" id="event-date">
                    </div>
                    
                    <div id="recurring-fields-group" style="display: none;">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Frequency</label>
                                <select id="event-frequency">
                                    <option value="monthly">Monthly</option>
                                    <option value="quarterly">Quarterly</option>
                                    <option value="annually" selected>Annually</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Start Date</label>
                                <input type="date" id="event-start-date">
                            </div>
                            <div class="form-group">
                                <label>End Date (Optional)</label>
                                <input type="date" id="event-end-date">
                            </div>
                        </div>
                    </div>

                    <div id="amount-fields-group">
                        <div class="form-row">
                            <div id="value-type-group" class="form-group">
                                <label>Value Type</label>
                                <select id="event-amount-type" onchange="handleValueTypeChange('unified')">
                                    <option value="fixed">Fixed Amount ($)</option>
                                    <option value="percent">Percentage (%)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label id="event-amount-label">Value (Amount or %)</label>
                                <input type="number" id="event-amount">
                            </div>
                        </div>
                    </div>

                    <div id="destination-group" class="form-group" style="display: none;">
                        <label>Withdrawal Destination</label>
                        <select id="withdrawal-destination">
                            <option value="external">External (Reduces Net Worth)</option>
                            <option value="cash">Cash Account (Internal Transfer)</option>
                        </select>
                    </div>

                    <div class="form-row" id="source-target-row">
                        <div id="source-group" class="form-group">
                            <label id="source-label">Source Account</label>
                            <select id="event-source"></select>
                        </div>
                        <div id="target-group" class="form-group">
                            <label id="target-label">Target Account</label>
                            <select id="event-target"></select>
                        </div>
                    </div>

                    <div class="form-group" id="description-group">
                        <label>Description (Optional)</label>
                        <input type="text" id="event-description">
                    </div>
                </div>

                <div id="rebalancing-fields" class="event-fields" style="display: none;">
                    <div id="rebalancing-preview-container" class="form-group">
                        <label>Target Percentages</label>
                        <div id="rebalancing-preview-list" class="rebalancing-preview-list">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-text" onclick="closeModal('event-modal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Event</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Other Modals simplified but functional -->
    <div class="modal" id="contact-modal"><div class="modal-content"><h3>Contact Us</h3><p>myprojectioncalculator@gmail.com</p><button onclick="closeModal('contact-modal')">Close</button></div></div>
    <div class="modal" id="privacy-policy-modal"><div class="modal-content"><h3>Privacy Policy</h3><button onclick="closeModal('privacy-policy-modal')">Close</button></div></div>
    <div class="modal" id="disclaimer-modal"><div class="modal-content"><h3>Disclaimer</h3><p>Not financial advice.</p><button onclick="closeModal('disclaimer-modal')">I Understand</button></div></div>
    <div class="modal" id="quick-event-type-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Event</h3>
                <button class="close-btn" onclick="closeModal('quick-event-type-modal')"><i data-lucide="x"></i></button>
            </div>
                <div class="modal-body">
                <div class="quick-event-buttons">
                    <button class="btn btn-outline" onclick="quickAddEventType('income')">
                        <i data-lucide="arrow-down-left"></i>
                        <span>Income</span>
                    </button>
                    <button class="btn btn-outline" onclick="quickAddEventType('expense')">
                        <i data-lucide="arrow-up-right"></i>
                        <span>Expense</span>
                    </button>
                    <button class="btn btn-outline" onclick="quickAddEventType('transfer')">
                        <i data-lucide="repeat"></i>
                        <span>Transfer</span>
                    </button>
                    <button class="btn btn-outline" onclick="quickAddEventType('withdrawal')">
                        <i data-lucide="wallet"></i>
                        <span>Withdrawal</span>
                    </button>
                    <button class="btn btn-outline" onclick="quickAddEventType('rebalancing')">
                        <i data-lucide="refresh-cw"></i>
                        <span>Rebalance</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="goal-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="goal-modal-title">Financial Goal</h3>
                <button class="close-btn" onclick="closeModal('goal-modal')"><i data-lucide="x"></i></button>
            </div>
            <form id="goal-form">
                <div class="form-group">
                    <label>Category</label>
                    <select id="goal-category" onchange="handleGoalCategoryChange()">
                        <option value="retirement">Retirement</option>
                        <option value="emergency-fund">Emergency Fund</option>
                        <option value="home">Home Purchase</option>
                        <option value="car">Car Purchase</option>
                        <option value="education">Education/College Fund</option>
                        <option value="vacation">Vacation/Travel</option>
                        <option value="investment">Investment Target</option>
                        <option value="other">Other / Custom</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Goal Name</label>
                    <input type="text" id="goal-name" placeholder="e.g., Early Retirement" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Target Amount ($)</label>
                        <input type="number" id="goal-amount" required>
                    </div>
                    <div class="form-group">
                        <label>Target Year</label>
                        <input type="number" id="goal-year" required>
                    </div>
                </div>
                <div class="form-group">
                    <label>Goal Type</label>
                    <select id="goal-type">
                        <option value="net-worth">Total Net Worth</option>
                        <option value="investment">Specific Asset Balance</option>
                    </select>
                </div>
                <div id="goal-target-asset-group" class="form-group" style="display: none;">
                    <label>Target Asset</label>
                    <select id="goal-target-asset"></select>
                </div>
                <div id="goal-deduct-group" class="form-group" style="display: none;">
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                        <input type="checkbox" id="goal-deduct" style="width: auto;">
                        <span>Deduct amount from asset when goal is reached?</span>
                    </label>
                    <span class="input-hint">Enable this to simulate the "purchase" or withdrawal once your goal balance is met.</span>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-text" onclick="closeModal('goal-modal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Goal</button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal" id="projection-details-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="details-modal-year">Year 2024 Details</h3>
                <button class="close-btn" onclick="closeModal('projection-details-modal')"><i data-lucide="x"></i></button>
            </div>
            <div class="details-body">
                <div class="details-stats-grid">
                    <div class="detail-stat-card">
                        <label>Net Worth</label>
                        <span id="details-net-worth">$0</span>
                    </div>
                    <div class="detail-stat-card">
                        <label>Total Growth</label>
                        <span id="details-growth" class="text-success">$0</span>
                    </div>
                </div>
                
                <h4 class="details-section-title">Asset Breakdown</h4>
                <div id="details-asset-list" class="details-list"></div>
                
                <h4 class="details-section-title">Events This Year</h4>
                <div id="details-event-list" class="details-list"></div>
            </div>
        </div>
    </div>

    <div id="toast-container"></div>
    <input type="file" id="import-file" style="display:none">

    <script src="script.js"></script>
    <script>
        // Initialize Lucide icons
        lucide.createIcons();
    </script>
</body>
</html>
